<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIS Core V2 - AI Business Management System</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/modules/sidebar.css">
    <link rel="stylesheet" href="assets/css/modules/tabs.css">
    <link rel="stylesheet" href="assets/css/modules/chat.css">
    <link rel="stylesheet" href="assets/css/modules/estimate.css">
    <link rel="stylesheet" href="assets/css/modules/erp.css">
</head>
<body>
    <!-- Main Container -->
    <div id="app" class="app-container">

        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <!-- Sidebar Toggle -->
            <button id="sidebarToggle" class="sidebar-toggle">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M3 12H21M3 6H21M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>

            <!-- Logo Section -->
            <div class="sidebar-header">
                <h1 class="logo">KIS Core V2</h1>
                <span class="version">v2.0.0</span>
            </div>

            <!-- Tab Navigation -->
            <nav class="tab-nav">
                <ul class="tab-list">
                    <li class="tab-item active" data-tab="ai-manager">
                        <svg class="tab-icon" width="20" height="20"><use href="#icon-chat"></use></svg>
                        <span>AI 매니저</span>
                    </li>
                    <li class="tab-item" data-tab="estimate">
                        <svg class="tab-icon" width="20" height="20"><use href="#icon-document"></use></svg>
                        <span>견적</span>
                    </li>
                    <li class="tab-item" data-tab="erp">
                        <svg class="tab-icon" width="20" height="20"><use href="#icon-chart"></use></svg>
                        <span>ERP</span>
                    </li>
                    <li class="tab-item" data-tab="email">
                        <svg class="tab-icon" width="20" height="20"><use href="#icon-mail"></use></svg>
                        <span>이메일</span>
                    </li>
                    <li class="tab-item" data-tab="calendar">
                        <svg class="tab-icon" width="20" height="20"><use href="#icon-calendar"></use></svg>
                        <span>캘린더</span>
                    </li>
                    <li class="tab-item" data-tab="drawing">
                        <svg class="tab-icon" width="20" height="20"><use href="#icon-drawing"></use></svg>
                        <span>도면</span>
                    </li>
                    <li class="tab-item" data-tab="settings">
                        <svg class="tab-icon" width="20" height="20"><use href="#icon-settings"></use></svg>
                        <span>설정</span>
                    </li>
                </ul>
            </nav>

            <!-- User Section -->
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">대표</div>
                    <span class="user-name">이충원</span>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Tab: AI Manager -->
            <section id="ai-manager" class="tab-content active">
                <div class="split-view">
                    <!-- Chat Area (35%) -->
                    <div class="chat-panel">
                        <div class="chat-header">
                            <h2>AI 매니저</h2>
                            <button class="new-chat-btn">+ 새 대화</button>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="message assistant">
                                <div class="message-content">
                                    안녕하세요! KIS Core V2 AI 매니저입니다.
                                    견적 작성, ERP 업무, 도면 분석 등 모든 업무를 도와드리겠습니다.
                                </div>
                            </div>
                        </div>
                        <div class="chat-input-area">
                            <div class="file-drop-zone" id="dropZone">
                                파일을 드래그하여 업로드하세요
                            </div>
                            <div class="chat-input-wrapper">
                                <textarea id="chatInput"
                                         class="chat-input"
                                         placeholder="메시지를 입력하세요..."
                                         rows="1"></textarea>
                                <button id="sendBtn" class="send-btn">
                                    <svg width="20" height="20" viewBox="0 0 20 20">
                                        <path d="M2 10L17 2L13 18L11 11L2 10Z" fill="currentColor"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Result Area (65%) -->
                    <div class="result-panel">
                        <div class="result-header">
                            <h3>결과</h3>
                            <div class="result-actions">
                                <button class="btn-evidence">증거 보기</button>
                                <button class="btn-export">내보내기</button>
                            </div>
                        </div>
                        <div class="result-content" id="resultContent">
                            <div class="welcome-message">
                                <h2>KIS Core V2에 오신 것을 환영합니다</h2>
                                <p>AI 매니저와 대화를 시작하여 업무를 처리하세요.</p>
                                <ul class="feature-list">
                                    <li>✓ FIX-4 파이프라인 견적 자동화</li>
                                    <li>✓ ERP 통합 관리</li>
                                    <li>✓ CAD 도면 분석 및 생성</li>
                                    <li>✓ 이메일 자동 발송</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab: Estimate -->
            <section id="estimate" class="tab-content">
                <div class="estimate-full-container">
                    <!-- 좌측 입력 패널 -->
                    <div class="estimate-left-panel">
                        <!-- 고객 정보 -->
                        <div class="section">
                            <div class="section-header">고객 정보</div>
                            <div class="section-content">
                                <div class="grid-2x2">
                                    <div class="form-row">
                                        <label class="form-label">업체명</label>
                                        <input type="text" class="form-input" placeholder="업체명을 입력하세요">
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">연락처</label>
                                        <input type="text" class="form-input" placeholder="연락처를 입력하세요">
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">이메일</label>
                                        <input type="email" class="form-input" placeholder="이메일을 입력하세요">
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">주소</label>
                                        <input type="text" class="form-input" placeholder="주소를 입력하세요">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 외함 정보 -->
                        <div class="section">
                            <div class="section-header">
                                외함
                                <div class="header-toggle-container">
                                    <div class="header-toggle">
                                        <button class="header-toggle-option active" onclick="toggleEnclosureType(this)">옥내</button>
                                        <button class="header-toggle-option" onclick="toggleEnclosureType(this)">옥외</button>
                                    </div>
                                </div>
                            </div>
                            <div class="section-content">
                                <div class="grid-1x2">
                                    <div class="form-row">
                                        <label class="form-label">함종류</label>
                                        <select class="form-select">
                                            <option>기성함</option>
                                            <option>주문제작함</option>
                                            <option>계량기함</option>
                                            <option>CT계량기함</option>
                                        </select>
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">재질</label>
                                        <select class="form-select">
                                            <option>STEEL 1.6T</option>
                                            <option>SUS304 1.5T</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 메인/분기 차단기 -->
                        <div class="section">
                            <div class="section-header">메인/분기 차단기</div>
                            <div class="section-content">
                                <div class="form-row">
                                    <label class="form-label">메인 차단기</label>
                                    <select class="form-select" id="mainBreakerSelect">
                                        <option value="">선택하세요</option>
                                        <option value="ELB">ELB</option>
                                        <option value="MCCB">MCCB</option>
                                        <option value="ACB">ACB</option>
                                    </select>
                                </div>
                                <div class="form-row" style="margin-top: 10px;">
                                    <label class="form-label">분기 차단기</label>
                                    <button class="btn btn-primary" onclick="openBranchSettings()">분기 설정</button>
                                </div>
                                <div id="branchList" class="branch-list" style="margin-top: 10px; display: none;">
                                    <!-- 분기 차단기 리스트 -->
                                </div>
                            </div>
                        </div>

                        <!-- 부속자재 -->
                        <div class="section">
                            <div class="section-header">부속자재</div>
                            <div class="section-content">
                                <button class="btn btn-primary" onclick="openAccessoriesModal()">부속자재 추가</button>
                                <div id="accessoriesList" class="accessories-list" style="margin-top: 10px;">
                                    <div class="accessories-list-empty">선택된 부속자재가 없습니다</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 우측 견적 결과 패널 -->
                    <div class="estimate-right-panel">
                        <div class="estimate-header">
                            <div class="estimate-title">견적서</div>
                            <div class="estimate-total">합계: ₩0</div>
                        </div>

                        <div class="estimate-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>품목</th>
                                        <th>규격</th>
                                        <th class="text-center">수량</th>
                                        <th class="text-right">단가</th>
                                        <th class="text-right">금액</th>
                                    </tr>
                                </thead>
                                <tbody id="estimateTableBody">
                                    <tr>
                                        <td colspan="5" class="text-center" style="color: #999;">견적 항목이 없습니다</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="bottom-buttons">
                            <button class="btn btn-primary" onclick="saveEstimate()">견적서 저장</button>
                            <button class="btn" onclick="exportEstimate()">Excel 내보내기</button>
                            <button class="btn" onclick="printEstimate()">인쇄</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab: ERP -->
            <section id="erp" class="tab-content">
                <div class="erp-container">
                    <h2>ERP 시스템</h2>
                    <div class="erp-modules">
                        <!-- 기초자료 등록 -->
                        <div class="erp-module">
                            <h3>기초자료 등록</h3>
                            <ul class="module-menu">
                                <li>자사정보등록</li>
                                <li>부서별사원등록</li>
                                <li>상품등록</li>
                                <li>거래처등록</li>
                                <li>신용카드등록 및 카드매입율 작성</li>
                                <li>입출금항목등록</li>
                                <li>자사은행계좌등록</li>
                            </ul>
                        </div>

                        <!-- 전자전송 -->
                        <div class="erp-module">
                            <h3>전자전송</h3>
                            <ul class="module-menu">
                                <li>이메일전송(거래명세서,견적서,발주서)</li>
                                <li>전자세금계산서</li>
                                <li>문자발송</li>
                                <li>팩스전송</li>
                            </ul>
                        </div>

                        <!-- 보고서 출력/저장 -->
                        <div class="erp-module">
                            <h3>보고서 출력/저장</h3>
                            <ul class="module-menu">
                                <li>거래명세서/보고서 프린트하기</li>
                                <li>엑셀,IMG,PDF파일 저장</li>
                                <li>명세서 위치 조기화 방법</li>
                            </ul>
                        </div>

                        <!-- 기초이월 -->
                        <div class="erp-module">
                            <h3>기초이월</h3>
                            <ul class="module-menu">
                                <li>상품재고이월</li>
                                <li>미수미지급금이월</li>
                                <li>은행잔고이월</li>
                                <li>어음이월</li>
                                <li>채권채무이월</li>
                                <li>현금잔고이월</li>
                            </ul>
                        </div>

                        <!-- 전표작성 -->
                        <div class="erp-module">
                            <h3>전표작성</h3>
                            <ul class="module-menu">
                                <li>매입/매출/수금/지급/입출금/조립전표</li>
                                <li>전표를 수정/삭제하는 방법</li>
                                <li>입출금(경비)등록 및 관련 항목</li>
                                <li>반품 처리하는 방법</li>
                                <li>거래처별 상품단가지정</li>
                                <li>단가관리 및 최종단가</li>
                                <li>전표 항목 초기화 방법</li>
                            </ul>
                        </div>

                        <!-- 재고 -->
                        <div class="erp-module">
                            <h3>재고</h3>
                            <ul class="module-menu">
                                <li>재고조정</li>
                                <li>원가재계산</li>
                            </ul>
                        </div>

                        <!-- 환경설정 -->
                        <div class="erp-module">
                            <h3>환경설정</h3>
                            <ul class="module-menu">
                                <li>기본설정</li>
                                <li>양식자 설정</li>
                                <li>문자자동전송</li>
                                <li>바코드 설정</li>
                                <li>프린트 설정</li>
                                <li>기타</li>
                                <li>급여 설정</li>
                            </ul>
                        </div>

                        <!-- 보고서 조회 -->
                        <div class="erp-module">
                            <h3>보고서 조회</h3>
                            <ul class="module-menu">
                                <li>매출명세서 조회</li>
                                <li>거래처별/상품별 매출현황 조회</li>
                                <li>일/월/일계표_상세 조회</li>
                                <li>기간별 통계분석</li>
                                <li>종합손익현황</li>
                                <li>원별현황자트</li>
                                <li>거래처별마진표</li>
                                <li>상품별/업체별 단가표</li>
                                <li>미수금 및 미지급금 조회 방법</li>
                                <li>보고서 상세 조회 옵션기 기능</li>
                            </ul>
                        </div>

                        <!-- 기타 -->
                        <div class="erp-module">
                            <h3>기타</h3>
                            <ul class="module-menu">
                                <li>사업장 마감</li>
                                <li>세사업장 구성(추가)방법</li>
                                <li>명세서 위치 조기화</li>
                                <li>자료의 백업과 복원방법</li>
                                <li>Data의 저장경로 변경</li>
                                <li>일정관리 기능</li>
                                <li>편리한 검색 기능</li>
                                <li>프로그램 단축키</li>
                                <li>피시 변경(데이터 이전) 방법</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab: Email -->
            <section id="email" class="tab-content">
                <div class="email-container">
                    <h2>이메일</h2>
                    <!-- 이메일 컨텐츠 -->
                </div>
            </section>

            <!-- Tab: Calendar -->
            <section id="calendar" class="tab-content">
                <div class="calendar-container">
                    <h2>캘린더</h2>
                    <!-- 캘린더 컨텐츠 -->
                </div>
            </section>

            <!-- Tab: Drawing -->
            <section id="drawing" class="tab-content">
                <div class="drawing-container">
                    <h2>도면 관리</h2>
                    <div class="drawing-toolbar">
                        <button class="btn-primary">새 도면</button>
                        <button class="btn-secondary">CAD 가져오기</button>
                        <button class="btn-secondary">SVG 내보내기</button>
                    </div>
                    <div class="drawing-canvas" id="drawingCanvas">
                        <!-- CAD/도면 뷰어 -->
                    </div>
                </div>
            </section>

            <!-- Tab: Settings -->
            <section id="settings" class="tab-content">
                <div class="settings-container">
                    <h2>설정</h2>
                    <div class="settings-sections">
                        <div class="settings-section">
                            <h3>API 연동</h3>
                            <div class="setting-item">
                                <label>OpenAI API Key</label>
                                <input type="password" placeholder="sk-..." class="input-field">
                            </div>
                            <div class="setting-item">
                                <label>Claude API Key</label>
                                <input type="password" placeholder="sk-ant-..." class="input-field">
                            </div>
                        </div>
                        <div class="settings-section">
                            <h3>모드 설정</h3>
                            <div class="setting-item">
                                <label>운영 모드</label>
                                <select class="select-field">
                                    <option value="LIVE">LIVE</option>
                                    <option value="MOCK">MOCK</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- SVG Icons -->
    <svg style="display: none;">
        <symbol id="icon-chat" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20Z" fill="currentColor"/>
        </symbol>
        <symbol id="icon-document" viewBox="0 0 24 24">
            <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2Z" fill="currentColor"/>
        </symbol>
        <symbol id="icon-chart" viewBox="0 0 24 24">
            <path d="M3 13H7V21H3V13ZM10 9H14V21H10V9ZM17 3H21V21H17V3Z" fill="currentColor"/>
        </symbol>
        <symbol id="icon-mail" viewBox="0 0 24 24">
            <path d="M20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4Z" fill="currentColor"/>
        </symbol>
        <symbol id="icon-calendar" viewBox="0 0 24 24">
            <path d="M19 3H18V1H16V3H8V1H6V3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3Z" fill="currentColor"/>
        </symbol>
        <symbol id="icon-drawing" viewBox="0 0 24 24">
            <path d="M3 17.25V21H6.75L17.81 9.94L14.06 6.19L3 17.25ZM20.71 7.04C21.1 6.65 21.1 6.02 20.71 5.63L18.37 3.29C17.98 2.9 17.35 2.9 16.96 3.29L15.13 5.12L18.88 8.87L20.71 7.04Z" fill="currentColor"/>
        </symbol>
        <symbol id="icon-settings" viewBox="0 0 24 24">
            <path d="M12 15.5C10.07 15.5 8.5 13.93 8.5 12C8.5 10.07 10.07 8.5 12 8.5C13.93 8.5 15.5 10.07 15.5 12C15.5 13.93 13.93 15.5 12 15.5ZM19.43 12.97L21.54 11.37C21.73 11.22 21.78 10.95 21.66 10.73L19.66 7.27C19.54 7.05 19.27 6.97 19.05 7.05L16.56 8.05C16.04 7.65 15.48 7.32 14.87 7.07L14.49 4.42C14.46 4.18 14.25 4 14 4H10C9.75 4 9.54 4.18 9.51 4.42L9.13 7.07C8.52 7.32 7.96 7.66 7.44 8.05L4.95 7.05C4.72 6.96 4.46 7.05 4.34 7.27L2.34 10.73C2.21 10.95 2.27 11.22 2.46 11.37L4.57 12.97L4.57 15.03L2.46 16.63C2.27 16.78 2.21 17.05 2.34 17.27L4.34 20.73C4.46 20.95 4.73 21.03 4.95 20.95L7.44 19.95C7.96 20.34 8.52 20.68 9.13 20.93L9.51 23.58C9.54 23.82 9.75 24 10 24H14C14.25 24 14.46 23.82 14.49 23.58L14.87 20.93C15.48 20.68 16.04 20.34 16.56 19.95L19.05 20.95C19.28 21.04 19.54 20.95 19.66 20.73L21.66 17.27C21.78 17.05 21.73 16.78 21.54 16.63L19.43 15.03L19.43 12.97Z" fill="currentColor"/>
        </symbol>
    </svg>

    <script src="assets/js/main.js"></script>
    <script src="assets/js/modules/chat.js"></script>
    <script src="assets/js/modules/erp.js"></script>
</body>
</html>